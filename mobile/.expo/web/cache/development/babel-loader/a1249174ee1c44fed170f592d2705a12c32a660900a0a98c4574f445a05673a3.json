{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuthProvider = exports.AuthContext = void 0;\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _react = _interopRequireWildcard(require(\"react\"));\nvar _asyncStorage = _interopRequireDefault(require(\"@react-native-async-storage/async-storage\"));\nvar _axios = _interopRequireDefault(require(\"axios\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _this = this,\n  _jsxFileName = \"D:\\\\Programming\\\\Systems\\\\Hybrid-Systems\\\\RespondaPH\\\\mobile\\\\src\\\\context\\\\AuthContext.js\";\nfunction _interopRequireWildcard(e, t) { if (\"function\" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function _interopRequireWildcard(e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (var _t in e) \"default\" !== _t && {}.hasOwnProperty.call(e, _t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, _t)) && (i.get || i.set) ? o(f, _t, i) : f[_t] = e[_t]); return f; })(e, t); }\nvar AuthContext = exports.AuthContext = (0, _react.createContext)();\nvar AuthProvider = exports.AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = (0, _react.useState)(null),\n    _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = (0, _react.useState)(null),\n    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n    token = _useState4[0],\n    setToken = _useState4[1];\n  var _useState5 = (0, _react.useState)(true),\n    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n    loading = _useState6[0],\n    setLoading = _useState6[1];\n  (0, _react.useEffect)(function () {\n    loadToken();\n  }, []);\n  var loadToken = function () {\n    var _ref2 = (0, _asyncToGenerator2.default)(function* () {\n      try {\n        var savedToken = yield _asyncStorage.default.getItem('token');\n        if (savedToken) {\n          setToken(savedToken);\n          yield fetchUserProfile(savedToken);\n        }\n      } catch (error) {\n        console.error('Failed to load token:', error);\n      } finally {\n        setLoading(false);\n      }\n    });\n    return function loadToken() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var fetchUserProfile = function () {\n    var _ref3 = (0, _asyncToGenerator2.default)(function* (authToken) {\n      try {\n        var response = yield _axios.default.get('http://10.0.2.2:5000/api/users/profile', {\n          headers: {\n            Authorization: `Bearer ${authToken}`\n          }\n        });\n        setUser(response.data);\n      } catch (error) {\n        console.error('Failed to fetch user:', error);\n        yield logout();\n      }\n    });\n    return function fetchUserProfile(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var login = function () {\n    var _ref4 = (0, _asyncToGenerator2.default)(function* (authToken, userData) {\n      yield _asyncStorage.default.setItem('token', authToken);\n      setToken(authToken);\n      setUser(userData);\n    });\n    return function login(_x2, _x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var logout = function () {\n    var _ref5 = (0, _asyncToGenerator2.default)(function* () {\n      yield _asyncStorage.default.removeItem('token');\n      setToken(null);\n      setUser(null);\n    });\n    return function logout() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  return (0, _jsxRuntime.jsx)(AuthContext.Provider, {\n    value: {\n      user: user,\n      token: token,\n      login: login,\n      logout: logout,\n      loading: loading\n    },\n    children: children\n  });\n};","map":{"version":3,"names":["_react","_interopRequireWildcard","require","_asyncStorage","_interopRequireDefault","_axios","_jsxRuntime","_this","_jsxFileName","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","AuthContext","exports","createContext","AuthProvider","_ref","children","_useState","useState","_useState2","_slicedToArray2","user","setUser","_useState3","_useState4","token","setToken","_useState5","_useState6","loading","setLoading","useEffect","loadToken","_ref2","_asyncToGenerator2","savedToken","AsyncStorage","getItem","fetchUserProfile","error","console","apply","arguments","_ref3","authToken","response","axios","headers","Authorization","data","logout","_x","login","_ref4","userData","setItem","_x2","_x3","_ref5","removeItem","jsx","Provider","value"],"sources":["D:/Programming/Systems/Hybrid-Systems/RespondaPH/mobile/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport axios from 'axios';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [token, setToken] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    loadToken();\r\n  }, []);\r\n\r\n  const loadToken = async () => {\r\n    try {\r\n      const savedToken = await AsyncStorage.getItem('token');\r\n      if (savedToken) {\r\n        setToken(savedToken);\r\n        await fetchUserProfile(savedToken);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load token:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchUserProfile = async (authToken) => {\r\n    try {\r\n      const response = await axios.get('http://10.0.2.2:5000/api/users/profile', {\r\n        headers: { Authorization: `Bearer ${authToken}` }\r\n      });\r\n      setUser(response.data);\r\n    } catch (error) {\r\n      console.error('Failed to fetch user:', error);\r\n      await logout();\r\n    }\r\n  };\r\n\r\n  const login = async (authToken, userData) => {\r\n    await AsyncStorage.setItem('token', authToken);\r\n    setToken(authToken);\r\n    setUser(userData);\r\n  };\r\n\r\n  const logout = async () => {\r\n    await AsyncStorage.removeItem('token');\r\n    setToken(null);\r\n    setUser(null);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, token, login, logout, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":";;;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,aAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,MAAA,GAAAD,sBAAA,CAAAF,OAAA;AAA0B,IAAAI,WAAA,GAAAJ,OAAA;AAAA,IAAAK,KAAA;EAAAC,YAAA;AAAA,SAAAP,wBAAAQ,CAAA,EAAAC,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAV,uBAAA,YAAAA,wBAAAQ,CAAA,EAAAC,CAAA,SAAAA,CAAA,IAAAD,CAAA,IAAAA,CAAA,CAAAK,UAAA,SAAAL,CAAA,MAAAM,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAC,OAAA,EAAAV,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAQ,CAAA,MAAAF,CAAA,GAAAL,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAG,CAAA,CAAAK,GAAA,CAAAX,CAAA,UAAAM,CAAA,CAAAM,GAAA,CAAAZ,CAAA,GAAAM,CAAA,CAAAO,GAAA,CAAAb,CAAA,EAAAQ,CAAA,cAAAM,EAAA,IAAAd,CAAA,gBAAAc,EAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,EAAA,OAAAP,CAAA,IAAAD,CAAA,GAAAW,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAnB,CAAA,EAAAc,EAAA,OAAAP,CAAA,CAAAK,GAAA,IAAAL,CAAA,CAAAM,GAAA,IAAAP,CAAA,CAAAE,CAAA,EAAAM,EAAA,EAAAP,CAAA,IAAAC,CAAA,CAAAM,EAAA,IAAAd,CAAA,CAAAc,EAAA,WAAAN,CAAA,KAAAR,CAAA,EAAAC,CAAA;AAEnB,IAAMmB,WAAW,GAAAC,OAAA,CAAAD,WAAA,GAAG,IAAAE,oBAAa,EAAC,CAAC;AAEnC,IAAMC,YAAY,GAAAF,OAAA,CAAAE,YAAA,GAAG,SAAfA,YAAYA,CAAAC,IAAA,EAAqB;EAAA,IAAfC,QAAQ,GAAAD,IAAA,CAARC,QAAQ;EACrC,IAAAC,SAAA,GAAwB,IAAAC,eAAQ,EAAC,IAAI,CAAC;IAAAC,UAAA,OAAAC,eAAA,CAAAnB,OAAA,EAAAgB,SAAA;IAA/BI,IAAI,GAAAF,UAAA;IAAEG,OAAO,GAAAH,UAAA;EACpB,IAAAI,UAAA,GAA0B,IAAAL,eAAQ,EAAC,IAAI,CAAC;IAAAM,UAAA,OAAAJ,eAAA,CAAAnB,OAAA,EAAAsB,UAAA;IAAjCE,KAAK,GAAAD,UAAA;IAAEE,QAAQ,GAAAF,UAAA;EACtB,IAAAG,UAAA,GAA8B,IAAAT,eAAQ,EAAC,IAAI,CAAC;IAAAU,UAAA,OAAAR,eAAA,CAAAnB,OAAA,EAAA0B,UAAA;IAArCE,OAAO,GAAAD,UAAA;IAAEE,UAAU,GAAAF,UAAA;EAE1B,IAAAG,gBAAS,EAAC,YAAM;IACdC,SAAS,CAAC,CAAC;EACb,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMA,SAAS;IAAA,IAAAC,KAAA,OAAAC,kBAAA,CAAAjC,OAAA,EAAG,aAAY;MAC5B,IAAI;QACF,IAAMkC,UAAU,SAASC,qBAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QACtD,IAAIF,UAAU,EAAE;UACdT,QAAQ,CAACS,UAAU,CAAC;UACpB,MAAMG,gBAAgB,CAACH,UAAU,CAAC;QACpC;MACF,CAAC,CAAC,OAAOI,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC/C,CAAC,SAAS;QACRT,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC;IAAA,gBAZKE,SAASA,CAAA;MAAA,OAAAC,KAAA,CAAAQ,KAAA,OAAAC,SAAA;IAAA;EAAA,GAYd;EAED,IAAMJ,gBAAgB;IAAA,IAAAK,KAAA,OAAAT,kBAAA,CAAAjC,OAAA,EAAG,WAAO2C,SAAS,EAAK;MAC5C,IAAI;QACF,IAAMC,QAAQ,SAASC,cAAK,CAAC3C,GAAG,CAAC,wCAAwC,EAAE;UACzE4C,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUJ,SAAS;UAAG;QAClD,CAAC,CAAC;QACFtB,OAAO,CAACuB,QAAQ,CAACI,IAAI,CAAC;MACxB,CAAC,CAAC,OAAOV,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;QAC7C,MAAMW,MAAM,CAAC,CAAC;MAChB;IACF,CAAC;IAAA,gBAVKZ,gBAAgBA,CAAAa,EAAA;MAAA,OAAAR,KAAA,CAAAF,KAAA,OAAAC,SAAA;IAAA;EAAA,GAUrB;EAED,IAAMU,KAAK;IAAA,IAAAC,KAAA,OAAAnB,kBAAA,CAAAjC,OAAA,EAAG,WAAO2C,SAAS,EAAEU,QAAQ,EAAK;MAC3C,MAAMlB,qBAAY,CAACmB,OAAO,CAAC,OAAO,EAAEX,SAAS,CAAC;MAC9ClB,QAAQ,CAACkB,SAAS,CAAC;MACnBtB,OAAO,CAACgC,QAAQ,CAAC;IACnB,CAAC;IAAA,gBAJKF,KAAKA,CAAAI,GAAA,EAAAC,GAAA;MAAA,OAAAJ,KAAA,CAAAZ,KAAA,OAAAC,SAAA;IAAA;EAAA,GAIV;EAED,IAAMQ,MAAM;IAAA,IAAAQ,KAAA,OAAAxB,kBAAA,CAAAjC,OAAA,EAAG,aAAY;MACzB,MAAMmC,qBAAY,CAACuB,UAAU,CAAC,OAAO,CAAC;MACtCjC,QAAQ,CAAC,IAAI,CAAC;MACdJ,OAAO,CAAC,IAAI,CAAC;IACf,CAAC;IAAA,gBAJK4B,MAAMA,CAAA;MAAA,OAAAQ,KAAA,CAAAjB,KAAA,OAAAC,SAAA;IAAA;EAAA,GAIX;EAED,OACE,IAAAtD,WAAA,CAAAwE,GAAA,EAACjD,WAAW,CAACkD,QAAQ;IAACC,KAAK,EAAE;MAAEzC,IAAI,EAAJA,IAAI;MAAEI,KAAK,EAALA,KAAK;MAAE2B,KAAK,EAALA,KAAK;MAAEF,MAAM,EAANA,MAAM;MAAErB,OAAO,EAAPA;IAAQ,CAAE;IAAAb,QAAA,EAClEA;EAAQ,CACW,CAAC;AAE3B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}